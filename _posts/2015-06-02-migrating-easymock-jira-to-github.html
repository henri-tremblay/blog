---
layout: post
title: Migrating EasyMock Jira to GitHub
date: '2015-06-02T19:44:00.001-07:00'
author: Henri Tremblay
tags:
- What I learned today
- Projects
modified_time: '2015-06-02T19:44:12.073-07:00'
blogger_id: tag:blogger.com,1999:blog-8282654404214414992.post-3054020877808895347
blogger_orig_url: http://blog.tremblay.pro/2015/06/migrating-easymock-jira-to-github.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Following my <a href="http://blog.tremblay.pro/2015/05/finish-migrating-objenesis-to-github.html" target="_blank">previous article</a>, I will now describe the Jira migration of EasyMock to <a href="https://github.com/easymock/easymock/issues" target="_blank">GitHub issue tracker</a>.<br /><br />EasyMock Jira was on Codehaus. So I had to migrate it somewhere else. Instead of migrating to another Jira instance I've decided that EasyMock doesn't need all that complexity anymore and that going to Github would enough.<br /><br />The migration was made in two steps:<br /><br /><ol style="text-align: left;"><li>Save everything on my disk</li><li>Import everything in GitHub</li></ol><div><a name='more'></a>The first step is important to keep all the original content in case it is needed.</div><div><br /></div><div>The final result is nice but some things can't be done:</div><div><ul style="text-align: left;"><li>Original authors of issues and comments are lost. They are now mentioned in the description but they are not the real authors anymore</li><li>Creation dates, modification dates, etc are lost</li></ul><div>The final code is <a href="https://github.com/henri-tremblay/jiramigrate" target="_blank">here</a>. If you need to do something similar it will be useful, however it can't be reused as is since it's not that clean. I also did some parts manually as you will see.&nbsp;</div><div><br /></div><h2 style="text-align: left;">Export (Export.java)</h2></div><div>I used the Spring <span style="font-family: Courier New, Courier, monospace;">RestTemplate</span> to retrieve my issues through the Jira API</div><div><ul style="text-align: left;"><li>The EASYMOCK project</li><li>All issues in the project&nbsp;</li><li>All fields to keep the meaning of the custom fields</li><li>All priorities to have the list</li><li>The project components</li><li>The project versions</li><li>The description of all users that have created or fixed an issue</li></ul><div>Then I've downloaded all attachments with <span style="font-family: Courier New, Courier, monospace;">wget</span>. I've create the list of attachments using a basic shell command (<span style="font-family: Courier New, Courier, monospace;">grep attachme issue*.json | grep content | cut -d: -f4</span>). Not pretty but it works.</div></div><div><br /></div><div>Everything is on my disk. Now I'm safe.</div><div><br /></div><h2 style="text-align: left;">Import (Import.java)</h2><div>The import was made in many steps. All could easily automated but it was quicker to just do them manually.</div><div><br /></div><div>GitHub doesn't have all Jira functionalities. There are no resolution field, affected version, &nbsp;priority, attachments or custom fields. So things need to be adapted.</div><div><ul style="text-align: left;"><li>Affected version is dropped</li><li>A fixed version becomes a milestone</li><li>A component is a label</li><li>A resolution is a label</li><li>Custom fields are dropped</li><li>A priority is a label</li><li>Attachments a pushed in a <a href="https://github.com/henri-tremblay/easymock-issue-attachments" target="_blank">dedicated repository</a></li></ul><h3 style="text-align: left;">Labels</h3></div><div>All labels were created manually. However you can look at <span style="font-family: Courier New, Courier, monospace;">CreateLabels.java</span> to see how it could be automated.</div><h3 style="text-align: left;">Milestones</h3><div>Each Jira version became a milestone. This was done automatically using the Github API. The code is in <span style="font-family: Courier New, Courier, monospace;">CreateMilestones.java</span>.</div><h3 style="text-align: left;">Attachments</h3><div>GitHub only supports images in attachment. The classical way to do an attachment of something else is to do a gist. I had a look at that and that's why you will see some code to create a gist in&nbsp;<span style="font-family: Courier New, Courier, monospace;">GitHubConnector.java</span>.</div><div><br /></div><div>However, I took another because I had TARs, ZIPs, JARs and other binaries in my attachment. So I've decided to push everything to a dedicated github repository and then reference the files in my issues.</div><h3 style="text-align: left;">Issues</h3><div>The final step was to migrate the issues themselves. I had a quick look at the <a href="https://code.google.com/p/support-tools/source/browse/googlecode-issues-exporter/github_issue_converter.py" target="_blank">code</a> used to migrate from Google Code to GitHub. There are two importants tricks in there.</div><div><ul style="text-align: left;"><li>You can't insert issues too quickly because you can go over the GitHub rate limit</li><li>You need to put some time between two comments to keep them in order because GitHub sorts the comments according to the timestamps</li></ul><div>As soon as you know that, it's basically a mapping from fields to fields. The only final trick is that GitHub issues only have two status: Open and Closed. A newly created issue is always in the Open status. So you then need to modify it to close it if needed.</div></div><div><br /></div><h2 style="text-align: left;">What is left to do</h2><div>I'm pretty much done for now. The only thing that is still missing it the release notes. Jira provides a page giving the release notes for each version. I need to regenerate them from the issues on a milestone.</div><div><br /></div><div>But I'll try to do some actual EasyMock code first... Cheers!</div></div>